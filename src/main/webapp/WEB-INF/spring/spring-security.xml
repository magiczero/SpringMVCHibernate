<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:sec="http://www.springframework.org/schema/security"
	xsi:schemaLocation="
      http://www.springframework.org/schema/security
      http://www.springframework.org/schema/security/spring-security-3.2.xsd
      http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans-4.0.xsd">
      <!-- <http auto-config="true">
        <intercept-url pattern="/hello*" access="ROLE_USER" />
	  </http> -->
	  <http pattern="/initLogin*" security="none" />
	  <http auto-config="false" access-denied-page="/403.jsp"><!--  authentication-manager-ref="authenticationManager" -->
	  	<form-login login-page="/initLogin"
	  			 login-processing-url="/login" username-parameter="username" password-parameter="password" always-use-default-target="true" authentication-success-handler-ref="authenticationSuccessHandler"/>
	  	<intercept-url pattern="/admin.jsp" access="ROLE_ADMIN" />
	  	<intercept-url pattern="/**" access="ROLE_USER" />
	  </http>
 	<!-- 认证成功后的处理类 -->
 	<beans:bean id="authenticationSuccessHandler" class="com.cngc.pm.security.AuthenticationSuccessHandlerImpl">
 		<beans:property name="defaultTargetUrl" value="/WEB-INF/main.jsp"></beans:property>
 		<beans:property name="forwardToDestination" value="true"></beans:property>
 	</beans:bean>
 	
    <!-- <authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="admin" password="123456" authorities="ROLE_USER" />
            </user-service>
            <jdbc-user-service data-source-ref="dataSource" />
        </authentication-provider>
    </authentication-manager> -->
    
    <beans:bean id="userDetailsService" class="com.cngc.pm.security.impl.UserDetailServiceImpl" />
    
    <authentication-manager alias="authenticationManager">
		<authentication-provider user-service-ref="userDetailsService" >
			<!-- 用户加密解密类  -->  
            <password-encoder hash="md5">
                <salt-source user-property="username"/>  
            </password-encoder> 
		</authentication-provider>
	</authentication-manager>
</beans:beans>